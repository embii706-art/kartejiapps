<!doctype html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#667eea" />
  
  <!-- Primary Meta Tags -->
  <title>KARTEJI v2.5.0 - Modern Organization Management</title>
  <meta name="title" content="KARTEJI v2.5.0 - Modern Organization Management" />
  <meta name="description" content="Modern SPA with premium UI, glassmorphism, 3D effects, and advanced features for organization management" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://kartejiapps.vercel.app/" />
  <meta property="og:title" content="KARTEJI v2.5.0 - Modern Organization Management" />
  <meta property="og:description" content="Modern SPA with premium UI, glassmorphism, 3D effects, and advanced features" />
  <meta property="og:image" content="/public/icon-512.png" />
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:url" content="https://kartejiapps.vercel.app/" />
  <meta property="twitter:title" content="KARTEJI v2.5.0 - Modern Organization Management" />
  <meta property="twitter:description" content="Modern SPA with premium UI, glassmorphism, 3D effects, and advanced features" />
  <meta property="twitter:image" content="/public/icon-512.png" />

  <link rel="manifest" href="/public/manifest.json" />
  <link rel="apple-touch-icon" href="/public/apple-touch-icon.png" />
  <link rel="icon" href="/public/apple-touch-icon.png" />

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { 
      darkMode: 'class', 
      theme: { 
        extend: {
          colors: {
            primary: {
              DEFAULT: '#667eea',
              50: '#f5f7ff',
              100: '#ebefff',
              500: '#667eea',
              600: '#5568d3',
              700: '#4553bc'
            }
          }
        } 
      } 
    }
  </script>
</head>

<body class="bg-slate-50 text-slate-900 dark:bg-[#0a0f1e] dark:text-slate-100">
  <div id="splash" class="fixed inset-0 z-[9999] flex items-center justify-center bg-gradient-dark">
    <div class="w-[min(360px,92vw)] rounded-2xl glass p-6 shadow-2xl text-center animate-splashPop">
      <img src="/public/apple-touch-icon.png" alt="Logo KARTEJI" class="w-[72px] h-[72px] mx-auto rounded-2xl shadow-lg object-cover" />
      <div class="mt-4 text-xl font-extrabold tracking-wide text-gradient">KARTEJI</div>
      <div class="text-xs text-slate-400 mt-1">v2.5.0</div>
      <div id="splashText" class="mt-2 text-sm text-slate-300">Memuat…</div>
      <div class="mt-4 h-2 rounded-full bg-slate-700/60 overflow-hidden">
        <div class="h-full w-1/3 rounded-full bg-gradient-primary animate-pulse"></div>
      </div>
    </div>
  </div>

  <main id="app" class="min-h-screen"></main>

  <script>
    (function(){
      const splash = document.getElementById('splash');
      const splashText = document.getElementById('splashText');
      const app = document.getElementById('app');

      function hideSplash(){
        if(!splash) return;
        splash.style.opacity = '0';
        splash.style.transition = 'opacity 220ms ease';
        setTimeout(()=> splash.remove(), 240);
      }

      function showError(title, detail){
        hideSplash();
        app.innerHTML = `
          <section class="p-4 max-w-md mx-auto space-y-3">
            <div class="rounded-2xl glass p-4">
              <div class="font-semibold text-base">${title}</div>
              <div class="text-sm opacity-80 mt-1">${detail}</div>
              <div class="flex gap-2 mt-3">
                <button id="btnReload" class="w-full rounded-xl px-4 py-2 btn-gradient">Muat Ulang</button>
                <button id="btnBypass" class="w-full rounded-xl px-4 py-2 border border-slate-300 dark:border-slate-700">Lewati Splash</button>
              </div>
              <div class="text-xs opacity-70 mt-3">
                Tips iOS: hapus cache Safari / uninstall PWA lalu install ulang.
              </div>
            </div>
          </section>
        `;
        document.getElementById('btnReload')?.addEventListener('click', ()=> location.reload());
        document.getElementById('btnBypass')?.addEventListener('click', ()=> { hideSplash(); location.hash = '#/home'; });
      }

      setTimeout(()=>{
        if (splashText) splashText.textContent = 'Menyiapkan aplikasi…';
        if (splash && document.body.contains(splash)) {
          hideSplash();
          if (app && !app.innerHTML.trim()) {
            app.innerHTML = `
              <section class="p-4 max-w-md mx-auto">
                <div class="rounded-2xl glass p-4">
                  <div class="font-semibold">UI belum tampil.</div>
                  <div class="text-sm opacity-80 mt-1">
                    Biasanya karena JavaScript utama tidak termuat di hosting (404 / path salah / cache SW).
                  </div>
                </div>
              </section>
            `;
          }
        }
      }, 5000);

      (async () => {
        try {
          if (splashText) splashText.textContent = 'Memuat modul…';
          await import('/src/main.js');
        } catch (e) {
          console.error('MAIN MODULE ERROR', e);
          const msg = (e && e.message) ? e.message : String(e);
          showError('Gagal memuat JavaScript aplikasi.',
            'Error: <code>' + msg.replace(/</g,'&lt;') + '</code><br/>Pastikan file <code>/src/main.js</code> ada di hasil deploy (tidak hilang saat build Vercel).'
          );
        }
      })();
    })();
  </script>
</body>
</html>
